%% R1 X1 R0 X0
data = [3.97000000000000 0.0990000000000000 3.97000000000000 0.0990000000000000;
    1.25700000000000 0.0850000000000000 1.25700000000000 0.0850000000000000;
    1.15000000000000 0.0880000000000000 1.20000000000000 0.0880000000000000;
    0.868000000000000 0.0920000000000000 0.760000000000000 0.0920000000000000;
    0.469000000000000 0.0750000000000000 1.58100000000000 0.0910000000000000;
    0.274000000000000 0.0730000000000000 0.959000000000000 0.0790000000000000;
    0.0890000000000000 0.0675000000000000 0.319000000000000 0.0760000000000000;
    0.166000000000000 0.0680000000000000 0.580000000000000 0.0780000000000000;
    0.446000000000000 0.0710000000000000 1.50500000000000 0.0830000000000000;
    0.322000000000000 0.0740000000000000 0.804000000000000 0.0930000000000000;]
%%
% Matriz de transformação
a=1*exp(i*120*pi/180);

T = [1 1 1;1 a^2 a;1 a a^2];

lcode = 3;
R1 = data(lcode,1);
X1 = data(lcode,2);
R0 = data(lcode,3);
X0 = data(lcode,4);

Z = [R0+i*X0 0 0;0 R1+i*X1 0;0 0 R1+i*X1];

Z_abc = inv(T)*Z*T;

string = strcat(num2str(real(Z_abc(1,1)),'%.7f'),',',num2str(imag(Z_abc(1,1)),'%.7f'),',',...
                num2str(real(Z_abc(1,2)),'%.7f'),',',num2str(imag(Z_abc(1,2)),'%.7f'),',',...
                num2str(real(Z_abc(1,3)),'%.7f'),',',num2str(imag(Z_abc(1,3)),'%.7f'),',',...
                num2str(real(Z_abc(2,2)),'%.7f'),',',num2str(imag(Z_abc(2,2)),'%.7f'),',',...
                num2str(real(Z_abc(2,3)),'%.7f'),',',num2str(imag(Z_abc(2,3)),'%.7f'),',',...
                num2str(real(Z_abc(3,3)),'%.7f'),',',num2str(imag(Z_abc(3,3)),'%.7f'))

